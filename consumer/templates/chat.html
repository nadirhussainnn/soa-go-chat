<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat - ChatApp</title>
    <link rel="stylesheet" href="/static/chat.css">
</head>
<body>
    <div class="chat-container">
        <!-- Chat Header -->
        <header_logout class="chat-header">
            <div class="profile-pic"></div>
            <div class="username">John Doe</div>
        </header_logout>

        <!-- Chat Messages -->
        <main class="chat-messages" id="chat-messages">
            <!-- Messages will be dynamically added here -->
        </main>

        <!-- Chat Input -->
        <footer class="chat-input">
            <form id="message-form">
                <input type="text" id="message-input" placeholder="Type a message" required>
                <label for="attachment">
                    <input type="file" id="attachment" style="display: none;">
                    ðŸ“Ž
                </label>
                <button type="submit">Send</button>
            </form>
        </footer>
    </div>

    <script>
        const chatMessages = document.getElementById('chat-messages');
        const messageForm = document.getElementById('message-form');
        const messageInput = document.getElementById('message-input');

        // WebSocket connection
        const socket = new WebSocket("ws://localhost:8085/ws");

        // Listen for messages from the server
        socket.onmessage = (event) => {
            const message = event.data;
            const time = new Date().toLocaleTimeString();
            const messageBubble = document.createElement('div');
            messageBubble.classList.add('message-bubble', 'received');
            messageBubble.innerHTML = `
                <p>${message}</p>
                <span class="message-time">${time}</span>
            `;
            chatMessages.appendChild(messageBubble);
            chatMessages.scrollTop = chatMessages.scrollHeight; // Scroll to the bottom
        };

        // Handle sending messages
        messageForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const content = messageInput.value.trim();
            if (content) {
                socket.send(content); // Send the message to the server
                const time = new Date().toLocaleTimeString();
                const messageBubble = document.createElement('div');
                messageBubble.classList.add('message-bubble', 'sent');
                messageBubble.innerHTML = `
                    <p>${content}</p>
                    <span class="message-time">${time}</span>
                `;
                chatMessages.appendChild(messageBubble);
                chatMessages.scrollTop = chatMessages.scrollHeight; // Scroll to the bottom
                messageInput.value = ''; // Clear input field
            }
        });
    </script>
</body>
</html>
